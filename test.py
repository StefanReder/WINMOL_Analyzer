from shapely import LineString, Point

from classes.Stem import Stem
from qgisutil.FeatureFactory import FeatureFactory

if __name__ == '__main__':
    a = LineString([
        [
            361156.58896794985,
            6003996.762501755
        ],
        [
            361156.20823973446,
            6003997.026082827
        ],
        [
            361155.7689379474,
            6003997.318950685
        ],
        [
            361154.3924590147,
            6003998.314701403
        ],
        [
            361153.98244401347,
            6003998.6368560465
        ],
        [
            361153.3967082974,
            6003999.076157833
        ],
        [
            361152.9866932962,
            6003999.369025691
        ]
    ])

    stem1 = Stem(
        stem_id=1909,
        path=a,
        start=Point(
            361154.7731872301,
            6003990.846571023
        ),
        stop=Point(
            361157.4968583097,
            6003990.905144595
        ),
        segment_volume_list=[
            0.004305881006598045,
            0.021641570747067584,
            0.02569845966691071,
            0.03233204097910344,
            0.03710009610640275,
            0.02764223892790801
        ],
        segment_diameter_list=[
            0.14643392898142338,
            0.20520117743424895,
            0.26368863414475346,
            0.23429428599774837,
            0.3222861088143731,
            0.2929945035305768,
            0.23591012782614462
        ],
        segment_length_list=[
            0.17572071484755725,
            0.49873599083334513,
            0.5271621444262564,
            0.5271621444844641,
            0.49873599083334513,
            0.5013090225121442
        ],
        vector=[(
            361154.7731872301,
            6003989.846571023
        ), (
            361154.7731872301,
            6003991.846571023
        )]
    )
    stems = [stem1]

    ff = FeatureFactory()
    feature = ff.create_stem_feature(stem1)
    print(feature.isValid())
    print(feature.geometry().asWkt())

    node_features = ff.create_subsidiary_features(stem1)
